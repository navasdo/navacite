<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grammar Grid</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }
        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
            transform: translate3d(0, 0, 0);
        }
        .word-box {
            cursor: pointer;
            user-select: none;
            transition: transform 0.2s, background-color 0.2s;
        }
        @keyframes glowing-border {
            0% { box-shadow: 0 0 10px #DA70D6, 0 0 20px #DA70D6; }
            50% { box-shadow: 0 0 20px #C3B1E1, 0 0 40px #C3B1E1; }
            100% { box-shadow: 0 0 10px #DA70D6, 0 0 20px #DA70D6; }
        }
        .glow {
            animation: glowing-border 1.5s ease-in-out forwards;
        }
        @keyframes word-pulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: none;
            }
            50% { 
                transform: scale(1.1);
                box-shadow: 0 0 15px rgba(218, 112, 214, 0.8), 0 0 30px rgba(195, 177, 225, 0.5);
            }
        }
        .word-box.animate {
            animation: word-pulse 2s ease-in-out forwards;
        }
        @keyframes blooming-glow {
            0%, 100% {
                filter: drop-shadow(0 0 5px rgba(218, 112, 214, 0.3));
            }
            50% {
                filter: drop-shadow(0 0 20px rgba(218, 112, 214, 0.9)) drop-shadow(0 0 30px rgba(195, 177, 225, 0.7));
            }
        }
        .image-glow {
            animation: blooming-glow 1.5s ease-in-out forwards;
        }
        @keyframes pulse-glow {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 10px rgba(218, 112, 214, 0.5));
            }
            50% {
                transform: scale(1.05);
                filter: drop-shadow(0 0 25px rgba(218, 112, 214, 1)) drop-shadow(0 0 40px rgba(195, 177, 225, 0.8));
            }
        }
        .loading-pulse {
            animation: pulse-glow 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Question Data Block -->
<script id="question-data" type="application/json">
[
    {
        "grade": "K",
        "id": 1,
        "words": [
            "the dog",
            "ran"
        ],
        "correct": [
            "The dog ran."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 2,
        "words": [
            "I",
            "can",
            "jump",
            "high"
        ],
        "correct": [
            "I can jump high."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 3,
        "words": [
            "the ball",
            "is",
            "big"
        ],
        "correct": [
            "The ball is big.",
            "Is the ball big?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 4,
        "words": [
            "we",
            "play",
            "outside"
        ],
        "correct": [
            "We play outside."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 5,
        "words": [
            "she",
            "has",
            "a hat"
        ],
        "correct": [
            "She has a hat."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 6,
        "words": [
            "the cat",
            "is",
            "black"
        ],
        "correct": [
            "The cat is black.",
            "Is the cat black?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 7,
        "words": [
            "he",
            "likes",
            "to",
            "read"
        ],
        "correct": [
            "He likes to read."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 8,
        "words": [
            "I",
            "am",
            "sleepy"
        ],
        "correct": [
            "I am sleepy."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 9,
        "words": [
            "the house",
            "is",
            "tall"
        ],
        "correct": [
            "The house is tall.",
            "Is the house tall?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 10,
        "words": [
            "they",
            "are",
            "friends"
        ],
        "correct": [
            "They are friends."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 11,
        "words": [
            "he",
            "went",
            "to the store"
        ],
        "correct": [
            "He went to the store."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 12,
        "words": [
            "the sun",
            "is",
            "hot"
        ],
        "correct": [
            "The sun is hot.",
            "Is the sun hot?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 13,
        "words": [
            "I",
            "see",
            "a bird"
        ],
        "correct": [
            "I see a bird."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 14,
        "words": [
            "she",
            "sings",
            "a song"
        ],
        "correct": [
            "She sings a song."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 15,
        "words": [
            "the fish",
            "is",
            "swimming"
        ],
        "correct": [
            "The fish is swimming.",
            "Is the fish swimming?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 16,
        "words": [
            "we",
            "eat",
            "dinner"
        ],
        "correct": [
            "We eat dinner."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 17,
        "words": [
            "the moon",
            "is",
            "yellow"
        ],
        "correct": [
            "The moon is yellow."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 18,
        "words": [
            "the girl",
            "is",
            "fast"
        ],
        "correct": [
            "The girl is fast.",
            "Is the girl fast?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 19,
        "words": [
            "he",
            "built",
            "a castle"
        ],
        "correct": [
            "He built a castle."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 20,
        "words": [
            "I",
            "have",
            "two",
            "books"
        ],
        "correct": [
            "I have two books."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 21,
        "words": [
            "the boy",
            "is",
            "smart"
        ],
        "correct": [
            "The boy is smart.",
            "Is the boy smart?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 22,
        "words": [
            "we",
            "need",
            "a coat"
        ],
        "correct": [
            "We need a coat."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 23,
        "words": [
            "she",
            "runs",
            "very",
            "fast"
        ],
        "correct": [
            "She runs very fast."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 24,
        "words": [
            "the truck",
            "is",
            "big"
        ],
        "correct": [
            "The truck is big.",
            "Is the truck big?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 25,
        "words": [
            "I",
            "like",
            "to",
            "draw"
        ],
        "correct": [
            "I like to draw."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 26,
        "words": [
            "he",
            "found",
            "his",
            "keys"
        ],
        "correct": [
            "He found his keys."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 27,
        "words": [
            "the car",
            "is",
            "new"
        ],
        "correct": [
            "The car is new.",
            "Is the car new?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 28,
        "words": [
            "they",
            "play",
            "with",
            "toys"
        ],
        "correct": [
            "They play with toys."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 29,
        "words": [
            "the baby",
            "is",
            "happy"
        ],
        "correct": [
            "The baby is happy."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 30,
        "words": [
            "the flower",
            "is",
            "pretty"
        ],
        "correct": [
            "The flower is pretty.",
            "Is the flower pretty?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 31,
        "words": [
            "I",
            "went",
            "to",
            "school",
            "today"
        ],
        "correct": [
            "I went to school today."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 32,
        "words": [
            "she",
            "wants",
            "to",
            "play"
        ],
        "correct": [
            "She wants to play."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 33,
        "words": [
            "the bird",
            "is",
            "singing"
        ],
        "correct": [
            "The bird is singing.",
            "Is the bird singing?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 34,
        "words": [
            "he",
            "drinks",
            "water"
        ],
        "correct": [
            "He drinks water."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 35,
        "words": [
            "the cat",
            "likes",
            "to",
            "sleep"
        ],
        "correct": [
            "The cat likes to sleep."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 36,
        "words": [
            "the book",
            "is",
            "blue"
        ],
        "correct": [
            "The book is blue.",
            "Is the book blue?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 37,
        "words": [
            "we",
            "have",
            "fun"
        ],
        "correct": [
            "We have fun."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 38,
        "words": [
            "she",
            "knows",
            "the answer"
        ],
        "correct": [
            "She knows the answer."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 39,
        "words": [
            "the cup",
            "is",
            "full"
        ],
        "correct": [
            "The cup is full.",
            "Is the cup full?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 40,
        "words": [
            "I",
            "finished",
            "my",
            "homework"
        ],
        "correct": [
            "I finished my homework."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 41,
        "words": [
            "the wind",
            "blows",
            "hard"
        ],
        "correct": [
            "The wind blows hard."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 42,
        "words": [
            "the door",
            "is",
            "open"
        ],
        "correct": [
            "The door is open.",
            "Is the door open?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 43,
        "words": [
            "he",
            "helped",
            "his",
            "friend"
        ],
        "correct": [
            "He helped his friend."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 44,
        "words": [
            "the train",
            "is",
            "fast"
        ],
        "correct": [
            "The train is fast."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 45,
        "words": [
            "the sky",
            "is",
            "clear"
        ],
        "correct": [
            "The sky is clear.",
            "Is the sky clear?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 46,
        "words": [
            "they",
            "built",
            "a fort"
        ],
        "correct": [
            "They built a fort."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 47,
        "words": [
            "the baby",
            "laughs",
            "loudly"
        ],
        "correct": [
            "The baby laughs loudly."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 48,
        "words": [
            "the pizza",
            "is",
            "hot"
        ],
        "correct": [
            "The pizza is hot.",
            "Is the pizza hot?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "K",
        "id": 49,
        "words": [
            "she",
            "rides",
            "a bike"
        ],
        "correct": [
            "She rides a bike."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "K",
        "id": 50,
        "words": [
            "the milk",
            "is",
            "cold"
        ],
        "correct": [
            "The milk is cold.",
            "Is the milk cold?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 1,
        "words": [
            "the man",
            "is",
            "a",
            "teacher"
        ],
        "correct": [
            "The man is a teacher."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 2,
        "words": [
            "the boy",
            "went",
            "to",
            "school"
        ],
        "correct": [
            "The boy went to school."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 3,
        "words": [
            "mary",
            "and",
            "I",
            "played",
            "outside"
        ],
        "correct": [
            "Mary and I played outside."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 4,
        "words": [
            "the girl",
            "is",
            "eating",
            "a snack"
        ],
        "correct": [
            "The girl is eating a snack."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 5,
        "words": [
            "are",
            "we",
            "going",
            "to the park"
        ],
        "correct": [
            "Are we going to the park?",
            "We are going to the park."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 6,
        "words": [
            "my mom",
            "made",
            "cookies",
            "for",
            "me"
        ],
        "correct": [
            "My mom made cookies for me."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 7,
        "words": [
            "on",
            "tuesday",
            "we",
            "have",
            "gym"
        ],
        "correct": [
            "On Tuesday, we have gym.",
            "We have gym on Tuesday."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "1",
        "id": 8,
        "words": [
            "the cat",
            "sleeps",
            "in",
            "its",
            "bed"
        ],
        "correct": [
            "The cat sleeps in its bed."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 9,
        "words": [
            "did",
            "the dog",
            "chase",
            "the ball"
        ],
        "correct": [
            "Did the dog chase the ball?",
            "The dog did chase the ball."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 10,
        "words": [
            "I",
            "went",
            "to",
            "New York",
            "with",
            "my dad"
        ],
        "correct": [
            "I went to New York with my dad."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 11,
        "words": [
            "we",
            "read",
            "books",
            "and",
            "magazines"
        ],
        "correct": [
            "We read books and magazines."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 12,
        "words": [
            "is",
            "the baby",
            "drinking",
            "milk"
        ],
        "correct": [
            "Is the baby drinking milk?",
            "The baby is drinking milk."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 13,
        "words": [
            "the teacher",
            "gave",
            "a prize",
            "to",
            "john"
        ],
        "correct": [
            "The teacher gave a prize to John."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 14,
        "words": [
            "the school bus",
            "is",
            "yellow",
            "and",
            "big"
        ],
        "correct": [
            "The school bus is yellow and big."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 15,
        "words": [
            "a frog",
            "can",
            "hop",
            "and",
            "jump"
        ],
        "correct": [
            "A frog can hop and jump."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 16,
        "words": [
            "the family",
            "went",
            "to",
            "florida",
            "in",
            "July"
        ],
        "correct": [
            "The family went to Florida in July."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 17,
        "words": [
            "did",
            "the boy",
            "go",
            "to the zoo"
        ],
        "correct": [
            "Did the boy go to the zoo?",
            "The boy did go to the zoo."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 18,
        "words": [
            "I",
            "ate",
            "an apple",
            "a pear",
            "and",
            "a peach"
        ],
        "correct": [
            "I ate an apple, a pear, and a peach."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 19,
        "words": [
            "the flowers",
            "are",
            "red",
            "blue",
            "and",
            "yellow"
        ],
        "correct": [
            "The flowers are red, blue, and yellow."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 20,
        "words": [
            "my birthday",
            "is",
            "in",
            "october"
        ],
        "correct": [
            "My birthday is in October."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 21,
        "words": [
            "the sun",
            "shines",
            "in",
            "the",
            "sky"
        ],
        "correct": [
            "The sun shines in the sky."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 22,
        "words": [
            "I",
            "ate",
            "pancakes",
            "for",
            "breakfast"
        ],
        "correct": [
            "I ate pancakes for breakfast."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 23,
        "words": [
            "did",
            "the students",
            "learn",
            "their lesson"
        ],
        "correct": [
            "Did the students learn their lesson?",
            "The students did learn their lesson."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 24,
        "words": [
            "he",
            "can",
            "write",
            "a",
            "letter"
        ],
        "correct": [
            "He can write a letter."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 25,
        "words": [
            "the girl",
            "walked",
            "across",
            "the",
            "street"
        ],
        "correct": [
            "The girl walked across the street."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 26,
        "words": [
            "my friend",
            "lives",
            "on",
            "main",
            "street"
        ],
        "correct": [
            "My friend lives on Main Street."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 27,
        "words": [
            "the boy",
            "threw",
            "the ball",
            "to",
            "lisa"
        ],
        "correct": [
            "The boy threw the ball to Lisa."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 28,
        "words": [
            "the box",
            "is",
            "under",
            "the",
            "bed"
        ],
        "correct": [
            "The box is under the bed."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 29,
        "words": [
            "do",
            "you",
            "want",
            "to play",
            "a game"
        ],
        "correct": [
            "Do you want to play a game?",
            "You want to play a game."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 30,
        "words": [
            "we",
            "saw",
            "a bear",
            "a deer",
            "and",
            "a fox"
        ],
        "correct": [
            "We saw a bear, a deer, and a fox."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 31,
        "words": [
            "is",
            "the party",
            "on",
            "saturday"
        ],
        "correct": [
            "Is the party on Saturday?",
            "The party is on Saturday."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 32,
        "words": [
            "she",
            "is",
            "riding",
            "her",
            "bicycle"
        ],
        "correct": [
            "She is riding her bicycle."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 33,
        "words": [
            "I",
            "put",
            "the toys",
            "in",
            "the box"
        ],
        "correct": [
            "I put the toys in the box."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 34,
        "words": [
            "we",
            "go",
            "to",
            "the library",
            "on",
            "monday"
        ],
        "correct": [
            "We go to the library on Monday."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 35,
        "words": [
            "did",
            "the girl",
            "find",
            "her toy"
        ],
        "correct": [
            "Did the girl find her toy?",
            "The girl did find her toy."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 36,
        "words": [
            "the big",
            "dog",
            "barked",
            "at",
            "the",
            "mailman"
        ],
        "correct": [
            "The big dog barked at the mailman."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 37,
        "words": [
            "he",
            "ate",
            "an orange",
            "a banana",
            "and",
            "grapes"
        ],
        "correct": [
            "He ate an orange, a banana, and grapes."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 38,
        "words": [
            "is",
            "the baby",
            "sleeping",
            "in",
            "the crib"
        ],
        "correct": [
            "Is the baby sleeping in the crib?",
            "The baby is sleeping in the crib."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 39,
        "words": [
            "the car",
            "is",
            "driving",
            "on",
            "the",
            "road"
        ],
        "correct": [
            "The car is driving on the road."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 40,
        "words": [
            "can",
            "we",
            "go",
            "to the beach",
            "in",
            "florida"
        ],
        "correct": [
            "Can we go to the beach in Florida?",
            "We can go to the beach in Florida."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 41,
        "words": [
            "the cat",
            "is",
            "sleeping",
            "on",
            "the",
            "blanket"
        ],
        "correct": [
            "The cat is sleeping on the blanket."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 42,
        "words": [
            "the boy",
            "built",
            "a rocket",
            "with",
            "his",
            "dad"
        ],
        "correct": [
            "The boy built a rocket with his dad."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 43,
        "words": [
            "do",
            "you",
            "like",
            "summer",
            "or",
            "winter"
        ],
        "correct": [
            "Do you like summer or winter?",
            "You like summer or winter."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 44,
        "words": [
            "my brother",
            "has",
            "a new",
            "game"
        ],
        "correct": [
            "My brother has a new game."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 45,
        "words": [
            "the baby",
            "crawled",
            "under",
            "the",
            "table"
        ],
        "correct": [
            "The baby crawled under the table."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 46,
        "words": [
            "he",
            "can",
            "ride",
            "a bike",
            "a scooter",
            "and",
            "a skateboard"
        ],
        "correct": [
            "He can ride a bike, a scooter, and a skateboard."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 47,
        "words": [
            "the man",
            "is",
            "cooking",
            "dinner",
            "in",
            "the kitchen"
        ],
        "correct": [
            "The man is cooking dinner in the kitchen."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 48,
        "words": [
            "the bird",
            "flew",
            "over",
            "the",
            "nest"
        ],
        "correct": [
            "The bird flew over the nest."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "1",
        "id": 49,
        "words": [
            "are",
            "you",
            "from",
            "New York"
        ],
        "correct": [
            "Are you from New York?",
            "You are from New York."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "1",
        "id": 50,
        "words": [
            "the students",
            "read",
            "about",
            "plants",
            "and",
            "animals"
        ],
        "correct": [
            "The students read about plants and animals."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 1,
        "words": [
            "the girl",
            "put the book",
            "on the shelf"
        ],
        "correct": [
            "The girl put the book on the shelf."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 2,
        "words": [
            "he",
            "didn't",
            "want",
            "to go",
            "to the store"
        ],
        "correct": [
            "He didn't want to go to the store."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 3,
        "words": [
            "after",
            "the movie",
            "ended",
            "we",
            "went home"
        ],
        "correct": [
            "After the movie ended, we went home.",
            "We went home after the movie ended."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "3",
        "id": 4,
        "words": [
            "the boy",
            "gave",
            "his sister",
            "a toy"
        ],
        "correct": [
            "The boy gave his sister a toy."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 5,
        "words": [
            "the cake",
            "which",
            "was chocolate",
            "was delicious"
        ],
        "correct": [
            "The cake, which was chocolate, was delicious.",
            "The cake was delicious which was chocolate."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "3",
        "id": 6,
        "words": [
            "shouldn't",
            "you",
            "have",
            "finished",
            "your homework"
        ],
        "correct": [
            "Shouldn't you have finished your homework?",
            "You shouldn't have finished your homework."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "3",
        "id": 7,
        "words": [
            "the team",
            "won the game",
            "because",
            "they",
            "practiced",
            "hard"
        ],
        "correct": [
            "The team won the game because they practiced hard.",
            "Because they practiced hard, the team won the game."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "3",
        "id": 8,
        "words": [
            "was",
            "the ball",
            "thrown",
            "by",
            "the boy"
        ],
        "correct": [
            "Was the ball thrown by the boy?",
            "The ball was thrown by the boy."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "3",
        "id": 9,
        "words": [
            "the girl",
            "wanted",
            "to buy",
            "a new",
            "dress"
        ],
        "correct": [
            "The girl wanted to buy a new dress."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 10,
        "words": [
            "the dog",
            "chased",
            "the cat",
            "up the",
            "tree"
        ],
        "correct": [
            "The dog chased the cat up the tree."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 11,
        "words": [
            "she",
            "is",
            "not only",
            "smart",
            "but also",
            "kind"
        ],
        "correct": [
            "She is not only smart but also kind."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 12,
        "words": [
            "wasn't",
            "the book",
            "read",
            "by the",
            "student"
        ],
        "correct": [
            "Wasn't the book read by the student?",
            "The book wasn't read by the student."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "3",
        "id": 13,
        "words": [
            "the man",
            "who",
            "lives",
            "next door",
            "is a",
            "doctor"
        ],
        "correct": [
            "The man who lives next door is a doctor."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 14,
        "words": [
            "the movie",
            "was",
            "directed",
            "by a",
            "famous",
            "director"
        ],
        "correct": [
            "The movie was directed by a famous director."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 15,
        "words": [
            "he",
            "likes",
            "to swim",
            "to hike",
            "and",
            "to bike"
        ],
        "correct": [
            "He likes to swim, to hike, and to bike."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 16,
        "words": [
            "while",
            "I was",
            "sleeping",
            "the cat",
            "played"
        ],
        "correct": [
            "While I was sleeping, the cat played.",
            "The cat played while I was sleeping."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "3",
        "id": 17,
        "words": [
            "the teacher",
            "gave",
            "the students",
            "a test"
        ],
        "correct": [
            "The teacher gave the students a test."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 18,
        "words": [
            "the car",
            "was",
            "repaired",
            "by the",
            "mechanic"
        ],
        "correct": [
            "The car was repaired by the mechanic."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 19,
        "words": [
            "hasn't",
            "he",
            "been",
            "to the",
            "doctor"
        ],
        "correct": [
            "Hasn't he been to the doctor?",
            "He hasn't been to the doctor."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "3",
        "id": 20,
        "words": [
            "the girl",
            "with",
            "the red",
            "hair",
            "is my",
            "sister"
        ],
        "correct": [
            "The girl with the red hair is my sister."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 21,
        "words": [
            "the storm",
            "which",
            "was strong",
            "caused",
            "damage"
        ],
        "correct": [
            "The storm, which was strong, caused damage.",
            "The storm caused damage which was strong."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "3",
        "id": 22,
        "words": [
            "the boy",
            "likes",
            "to read",
            "books"
        ],
        "correct": [
            "The boy likes to read books."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 23,
        "words": [
            "the letter",
            "was",
            "delivered",
            "by the",
            "mailman"
        ],
        "correct": [
            "The letter was delivered by the mailman."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 24,
        "words": [
            "whenever",
            "it rains",
            "I",
            "stay",
            "inside"
        ],
        "correct": [
            "Whenever it rains, I stay inside.",
            "I stay inside whenever it rains."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "3",
        "id": 25,
        "words": [
            "she",
            "is",
            "either",
            "at home",
            "or",
            "at the library"
        ],
        "correct": [
            "She is either at home or at the library."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 26,
        "words": [
            "couldn't",
            "you",
            "find",
            "the",
            "keys"
        ],
        "correct": [
            "Couldn't you find the keys?",
            "You couldn't find the keys."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "3",
        "id": 27,
        "words": [
            "the dog",
            "that",
            "barks",
            "loudly",
            "is",
            "annoying"
        ],
        "correct": [
            "The dog that barks loudly is annoying."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 28,
        "words": [
            "the cake",
            "was",
            "eaten",
            "by the",
            "children"
        ],
        "correct": [
            "The cake was eaten by the children."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 29,
        "words": [
            "he",
            "is",
            "neither",
            "a doctor",
            "nor",
            "a lawyer"
        ],
        "correct": [
            "He is neither a doctor nor a lawyer."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 30,
        "words": [
            "unless",
            "you study",
            "you will",
            "not",
            "pass"
        ],
        "correct": [
            "Unless you study, you will not pass.",
            "You will not pass unless you study."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "3",
        "id": 31,
        "words": [
            "the girl",
            "who",
            "is tall",
            "is a",
            "basketball",
            "player"
        ],
        "correct": [
            "The girl who is tall is a basketball player."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 32,
        "words": [
            "where",
            "was",
            "the car",
            "parked",
            "by the",
            "driver"
        ],
        "correct": [
            "Where was the car parked by the driver?",
            "The car was parked by the driver where?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "3",
        "id": 33,
        "words": [
            "the book",
            "was so",
            "interesting",
            "that",
            "I",
            "read it twice"
        ],
        "correct": [
            "The book was so interesting that I read it twice."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 34,
        "words": [
            "the game",
            "was",
            "won",
            "by our",
            "team"
        ],
        "correct": [
            "The game was won by our team."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 35,
        "words": [
            "if",
            "you are",
            "tired",
            "you",
            "should",
            "rest"
        ],
        "correct": [
            "If you are tired, you should rest.",
            "You should rest if you are tired."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "3",
        "id": 36,
        "words": [
            "the boy",
            "is",
            "both",
            "athletic",
            "and",
            "smart"
        ],
        "correct": [
            "The boy is both athletic and smart."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 37,
        "words": [
            "the money",
            "was",
            "stolen",
            "by the",
            "thief"
        ],
        "correct": [
            "The money was stolen by the thief."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 38,
        "words": [
            "why",
            "was",
            "the window",
            "broken",
            "by the",
            "boy"
        ],
        "correct": [
            "Why was the window broken by the boy?",
            "The window was broken by the boy why?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "3",
        "id": 39,
        "words": [
            "she",
            "is",
            "as",
            "beautiful",
            "as a",
            "flower"
        ],
        "correct": [
            "She is as beautiful as a flower."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 40,
        "words": [
            "the house",
            "which",
            "is white",
            "has a",
            "red",
            "door"
        ],
        "correct": [
            "The house, which is white, has a red door.",
            "The house has a red door which is white."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "3",
        "id": 41,
        "words": [
            "the letter",
            "was",
            "written",
            "by",
            "my grandpa"
        ],
        "correct": [
            "The letter was written by my grandpa."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 42,
        "words": [
            "although",
            "it was",
            "cold",
            "he",
            "went",
            "outside"
        ],
        "correct": [
            "Although it was cold, he went outside.",
            "He went outside although it was cold."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "3",
        "id": 43,
        "words": [
            "my friend",
            "gave",
            "me",
            "a new",
            "book"
        ],
        "correct": [
            "My friend gave me a new book."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 44,
        "words": [
            "the cat",
            "was",
            "chased",
            "by",
            "the dog"
        ],
        "correct": [
            "The cat was chased by the dog."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 45,
        "words": [
            "who",
            "was",
            "the letter",
            "written",
            "by"
        ],
        "correct": [
            "Who was the letter written by?",
            "The letter was written by who?"
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "3",
        "id": 46,
        "words": [
            "the students",
            "who",
            "are smart",
            "finished",
            "their work"
        ],
        "correct": [
            "The students who are smart finished their work."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 47,
        "words": [
            "the party",
            "was",
            "planned",
            "by",
            "my mom"
        ],
        "correct": [
            "The party was planned by my mom."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 48,
        "words": [
            "can't",
            "you",
            "see",
            "the movie",
            "with me"
        ],
        "correct": [
            "Can't you see the movie with me?",
            "You can't see the movie with me."
        ],
        "types": [
            "Interrogative"
        ],
        "required": 2
    },
    {
        "grade": "3",
        "id": 49,
        "words": [
            "the food",
            "was",
            "cooked",
            "by",
            "the chef"
        ],
        "correct": [
            "The food was cooked by the chef."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "3",
        "id": 50,
        "words": [
            "since",
            "it is",
            "raining",
            "we will",
            "stay",
            "inside"
        ],
        "correct": [
            "Since it is raining, we will stay inside.",
            "We will stay inside since it is raining."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "4",
        "id": 1,
        "words": [
            "the man",
            "who",
            "is wearing",
            "a red shirt",
            "is a doctor"
        ],
        "correct": [
            "The man, who is wearing a red shirt, is a doctor.",
            "The man who is wearing a red shirt is a doctor."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "4",
        "id": 2,
        "words": [
            "the students",
            "were excited",
            "to go",
            "on the trip"
        ],
        "correct": [
            "The students were excited to go on the trip."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 3,
        "words": [
            "the boy",
            "gave his",
            "sister",
            "a gift",
            "for her birthday"
        ],
        "correct": [
            "The boy gave his sister a gift for her birthday.",
            "The boy gave a gift to his sister for her birthday."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "4",
        "id": 4,
        "words": [
            "the dog",
            "that",
            "is barking",
            "belongs",
            "to my neighbor"
        ],
        "correct": [
            "The dog that is barking belongs to my neighbor."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 5,
        "words": [
            "she",
            "wanted",
            "to",
            "learn",
            "how to swim"
        ],
        "correct": [
            "She wanted to learn how to swim."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 6,
        "words": [
            "the children",
            "who",
            "are playing",
            "are",
            "my cousins"
        ],
        "correct": [
            "The children who are playing are my cousins."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 7,
        "words": [
            "the girl",
            "wrote a letter",
            "to her",
            "grandmother"
        ],
        "correct": [
            "The girl wrote a letter to her grandmother.",
            "The girl wrote her grandmother a letter."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "4",
        "id": 8,
        "words": [
            "the house",
            "that",
            "is on the",
            "corner",
            "is",
            "for sale"
        ],
        "correct": [
            "The house that is on the corner is for sale."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 9,
        "words": [
            "he",
            "is not only",
            "a good",
            "student",
            "but also",
            "an athlete"
        ],
        "correct": [
            "He is not only a good student but also an athlete."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 10,
        "words": [
            "the car",
            "which",
            "is red",
            "is",
            "parked",
            "outside"
        ],
        "correct": [
            "The car, which is red, is parked outside.",
            "The car is parked outside which is red."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "4",
        "id": 11,
        "words": [
            "she",
            "is either",
            "going to",
            "the movies",
            "or",
            "the park"
        ],
        "correct": [
            "She is either going to the movies or the park."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 12,
        "words": [
            "the teacher",
            "gave",
            "the students",
            "a reward"
        ],
        "correct": [
            "The teacher gave the students a reward."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 13,
        "words": [
            "the boy",
            "who",
            "is my",
            "friend",
            "is",
            "very",
            "funny"
        ],
        "correct": [
            "The boy who is my friend is very funny."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 14,
        "words": [
            "he",
            "is neither",
            "a doctor",
            "nor",
            "a dentist"
        ],
        "correct": [
            "He is neither a doctor nor a dentist."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 15,
        "words": [
            "the book",
            "was so",
            "good",
            "that",
            "I couldn't",
            "put it down"
        ],
        "correct": [
            "The book was so good that I couldn't put it down."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 16,
        "words": [
            "the girl",
            "is",
            "as",
            "smart",
            "as her",
            "brother"
        ],
        "correct": [
            "The girl is as smart as her brother."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 17,
        "words": [
            "the dog",
            "is",
            "both",
            "friendly",
            "and",
            "playful"
        ],
        "correct": [
            "The dog is both friendly and playful."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 18,
        "words": [
            "the meal",
            "was",
            "prepared",
            "by the",
            "chef"
        ],
        "correct": [
            "The meal was prepared by the chef."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 19,
        "words": [
            "the letter",
            "was",
            "written",
            "by the",
            "girl"
        ],
        "correct": [
            "The letter was written by the girl."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 20,
        "words": [
            "the test",
            "was",
            "taken",
            "by the",
            "students"
        ],
        "correct": [
            "The test was taken by the students."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 21,
        "words": [
            "the cake",
            "was",
            "eaten",
            "by the",
            "guests"
        ],
        "correct": [
            "The cake was eaten by the guests."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 22,
        "words": [
            "the ball",
            "was",
            "thrown",
            "by the",
            "pitcher"
        ],
        "correct": [
            "The ball was thrown by the pitcher."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 23,
        "words": [
            "the song",
            "was",
            "sung",
            "by the",
            "choir"
        ],
        "correct": [
            "The song was sung by the choir."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 24,
        "words": [
            "the picture",
            "was",
            "taken",
            "by the",
            "photographer"
        ],
        "correct": [
            "The picture was taken by the photographer."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 25,
        "words": [
            "the race",
            "was",
            "won",
            "by the",
            "runner"
        ],
        "correct": [
            "The race was won by the runner."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 26,
        "words": [
            "the book",
            "was",
            "read",
            "by the",
            "class"
        ],
        "correct": [
            "The book was read by the class."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 27,
        "words": [
            "the car",
            "was",
            "driven",
            "by the",
            "woman"
        ],
        "correct": [
            "The car was driven by the woman."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 28,
        "words": [
            "the movie",
            "was",
            "watched",
            "by the",
            "family"
        ],
        "correct": [
            "The movie was watched by the family."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 29,
        "words": [
            "the window",
            "was",
            "broken",
            "by the",
            "storm"
        ],
        "correct": [
            "The window was broken by the storm."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 30,
        "words": [
            "the house",
            "was",
            "built",
            "by the",
            "workers"
        ],
        "correct": [
            "The house was built by the workers."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 31,
        "words": [
            "the game",
            "was",
            "played",
            "by the",
            "children"
        ],
        "correct": [
            "The game was played by the children."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 32,
        "words": [
            "the gift",
            "was",
            "given",
            "by the",
            "man"
        ],
        "correct": [
            "The gift was given by the man."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 33,
        "words": [
            "the treasure",
            "was",
            "found",
            "by the",
            "explorer"
        ],
        "correct": [
            "The treasure was found by the explorer."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 34,
        "words": [
            "the cat",
            "was",
            "chased",
            "by the",
            "dog"
        ],
        "correct": [
            "The cat was chased by the dog."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 35,
        "words": [
            "the money",
            "was",
            "stolen",
            "by the",
            "thief"
        ],
        "correct": [
            "The money was stolen by the thief."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 36,
        "words": [
            "the party",
            "was",
            "planned",
            "by the",
            "committee"
        ],
        "correct": [
            "The party was planned by the committee."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 37,
        "words": [
            "the dinner",
            "was",
            "cooked",
            "by the",
            "mother"
        ],
        "correct": [
            "The dinner was cooked by the mother."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 38,
        "words": [
            "the phone",
            "was",
            "answered",
            "by the",
            "secretary"
        ],
        "correct": [
            "The phone was answered by the secretary."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 39,
        "words": [
            "the door",
            "was",
            "closed",
            "by the",
            "teacher"
        ],
        "correct": [
            "The door was closed by the teacher."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 40,
        "words": [
            "the problem",
            "was",
            "solved",
            "by the",
            "student"
        ],
        "correct": [
            "The problem was solved by the student."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 41,
        "words": [
            "the box",
            "was",
            "opened",
            "by the",
            "boy"
        ],
        "correct": [
            "The box was opened by the boy."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 42,
        "words": [
            "the dog",
            "which",
            "is big",
            "ate",
            "all the food"
        ],
        "correct": [
            "The dog, which is big, ate all the food.",
            "The dog ate all the food which is big."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "4",
        "id": 43,
        "words": [
            "he",
            "was",
            "surprised",
            "by the",
            "gift"
        ],
        "correct": [
            "He was surprised by the gift."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 44,
        "words": [
            "the house",
            "was",
            "painted",
            "by",
            "the crew"
        ],
        "correct": [
            "The house was painted by the crew."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 45,
        "words": [
            "the game",
            "which",
            "was fun",
            "was",
            "played",
            "by all"
        ],
        "correct": [
            "The game, which was fun, was played by all.",
            "The game was played by all which was fun."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "4",
        "id": 46,
        "words": [
            "the woman",
            "who",
            "lives next door",
            "gave",
            "me",
            "flowers"
        ],
        "correct": [
            "The woman who lives next door gave me flowers.",
            "The woman who lives next door gave flowers to me."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "4",
        "id": 47,
        "words": [
            "he",
            "didn't",
            "want",
            "to",
            "go",
            "to bed"
        ],
        "correct": [
            "He didn't want to go to bed."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 48,
        "words": [
            "the car",
            "was",
            "washed",
            "by",
            "the kids"
        ],
        "correct": [
            "The car was washed by the kids."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 49,
        "words": [
            "the book",
            "that",
            "I read",
            "was",
            "a mystery"
        ],
        "correct": [
            "The book that I read was a mystery."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "4",
        "id": 50,
        "words": [
            "the girl",
            "who",
            "is my sister",
            "is",
            "a good",
            "singer"
        ],
        "correct": [
            "The girl who is my sister is a good singer."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 1,
        "words": [
            "he",
            "has",
            "painted",
            "the fence"
        ],
        "correct": [
            "He has painted the fence."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 2,
        "words": [
            "either",
            "the dog",
            "or the cat",
            "is",
            "on the bed"
        ],
        "correct": [
            "Either the dog or the cat is on the bed."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 3,
        "words": [
            "my sister",
            "and",
            "I",
            "have finished",
            "our homework"
        ],
        "correct": [
            "My sister and I have finished our homework."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 4,
        "words": [
            "the girl",
            "had",
            "eaten",
            "her dinner",
            "before she went to bed"
        ],
        "correct": [
            "The girl had eaten her dinner before she went to bed."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 5,
        "words": [
            "neither",
            "the students",
            "nor the teacher",
            "was",
            "in the classroom"
        ],
        "correct": [
            "Neither the students nor the teacher was in the classroom."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 6,
        "words": [
            "the children",
            "have",
            "played",
            "in the park",
            "all morning"
        ],
        "correct": [
            "The children have played in the park all morning."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 7,
        "words": [
            "the movie",
            "which",
            "we saw",
            "was",
            "a comedy"
        ],
        "correct": [
            "The movie, which we saw, was a comedy.",
            "The movie was a comedy which we saw."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "5",
        "id": 8,
        "words": [
            "he",
            "had been",
            "studying",
            "for hours",
            "before he took a break"
        ],
        "correct": [
            "He had been studying for hours before he took a break."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 9,
        "words": [
            "not only",
            "is he smart",
            "but he is also",
            "a great",
            "artist"
        ],
        "correct": [
            "Not only is he smart, but he is also a great artist."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 10,
        "words": [
            "the package",
            "was",
            "delivered",
            "by the",
            "courier"
        ],
        "correct": [
            "The package was delivered by the courier."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 11,
        "words": [
            "the team",
            "will have",
            "finished",
            "the project",
            "by next week"
        ],
        "correct": [
            "The team will have finished the project by next week."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 12,
        "words": [
            "the cake",
            "was made",
            "by the baker",
            "for the wedding"
        ],
        "correct": [
            "The cake was made by the baker for the wedding."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 13,
        "words": [
            "both",
            "the boy",
            "and the girl",
            "are",
            "in the band"
        ],
        "correct": [
            "Both the boy and the girl are in the band."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 14,
        "words": [
            "the students",
            "had been",
            "working",
            "on the assignment",
            "all day"
        ],
        "correct": [
            "The students had been working on the assignment all day."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 15,
        "words": [
            "the book",
            "that",
            "is on the table",
            "was",
            "written",
            "by my friend"
        ],
        "correct": [
            "The book that is on the table was written by my friend."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 16,
        "words": [
            "the teacher",
            "gave",
            "the students",
            "a",
            "difficult",
            "assignment"
        ],
        "correct": [
            "The teacher gave the students a difficult assignment."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 17,
        "words": [
            "the children",
            "will be",
            "going",
            "to the zoo",
            "tomorrow"
        ],
        "correct": [
            "The children will be going to the zoo tomorrow."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 18,
        "words": [
            "the letter",
            "was",
            "sent",
            "to the wrong",
            "address"
        ],
        "correct": [
            "The letter was sent to the wrong address."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 19,
        "words": [
            "the team",
            "has",
            "won",
            "the championship",
            "three times"
        ],
        "correct": [
            "The team has won the championship three times."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 20,
        "words": [
            "the girl",
            "who",
            "is a great",
            "dancer",
            "is",
            "my",
            "cousin"
        ],
        "correct": [
            "The girl who is a great dancer is my cousin."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 21,
        "words": [
            "the problem",
            "was",
            "solved",
            "by the clever",
            "student"
        ],
        "correct": [
            "The problem was solved by the clever student."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 22,
        "words": [
            "the boy",
            "had",
            "finished",
            "his homework",
            "before he went out to play"
        ],
        "correct": [
            "The boy had finished his homework before he went out to play."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 23,
        "words": [
            "the music",
            "was",
            "played",
            "by a famous",
            "orchestra"
        ],
        "correct": [
            "The music was played by a famous orchestra."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 24,
        "words": [
            "the teacher",
            "gave",
            "the class",
            "a",
            "surprise",
            "quiz"
        ],
        "correct": [
            "The teacher gave the class a surprise quiz."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 25,
        "words": [
            "the team",
            "will have",
            "practiced",
            "for weeks",
            "before the game"
        ],
        "correct": [
            "The team will have practiced for weeks before the game."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 26,
        "words": [
            "the movie",
            "had been",
            "seen",
            "by millions",
            "of people"
        ],
        "correct": [
            "The movie had been seen by millions of people."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 27,
        "words": [
            "the boy",
            "is",
            "as",
            "tall",
            "as his",
            "father"
        ],
        "correct": [
            "The boy is as tall as his father."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 28,
        "words": [
            "the students",
            "have",
            "learned",
            "a lot",
            "this year"
        ],
        "correct": [
            "The students have learned a lot this year."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 29,
        "words": [
            "the food",
            "was",
            "prepared",
            "with",
            "fresh",
            "ingredients"
        ],
        "correct": [
            "The food was prepared with fresh ingredients."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 30,
        "words": [
            "the girl",
            "has",
            "been",
            "playing",
            "the piano",
            "for years"
        ],
        "correct": [
            "The girl has been playing the piano for years."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 31,
        "words": [
            "the car",
            "was",
            "repaired",
            "by a",
            "skilled",
            "mechanic"
        ],
        "correct": [
            "The car was repaired by a skilled mechanic."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 32,
        "words": [
            "he",
            "will have",
            "been",
            "working",
            "for eight",
            "hours"
        ],
        "correct": [
            "He will have been working for eight hours."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 33,
        "words": [
            "the team",
            "is",
            "both",
            "talented",
            "and",
            "hardworking"
        ],
        "correct": [
            "The team is both talented and hardworking."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 34,
        "words": [
            "the children",
            "have",
            "been",
            "reading",
            "all afternoon"
        ],
        "correct": [
            "The children have been reading all afternoon."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 35,
        "words": [
            "the test",
            "was",
            "graded",
            "by the",
            "teacher"
        ],
        "correct": [
            "The test was graded by the teacher."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 36,
        "words": [
            "the family",
            "had",
            "lived",
            "in the house",
            "for ten",
            "years"
        ],
        "correct": [
            "The family had lived in the house for ten years."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 37,
        "words": [
            "the painting",
            "was",
            "admired",
            "by",
            "the art",
            "critic"
        ],
        "correct": [
            "The painting was admired by the art critic."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 38,
        "words": [
            "she",
            "had been",
            "waiting",
            "for the bus",
            "for a long",
            "time"
        ],
        "correct": [
            "She had been waiting for the bus for a long time."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 39,
        "words": [
            "the gift",
            "was",
            "wrapped",
            "in",
            "beautiful",
            "paper"
        ],
        "correct": [
            "The gift was wrapped in beautiful paper."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 40,
        "words": [
            "the dog",
            "has",
            "been",
            "barking",
            "all",
            "night"
        ],
        "correct": [
            "The dog has been barking all night."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 41,
        "words": [
            "the project",
            "was",
            "completed",
            "by the",
            "team"
        ],
        "correct": [
            "The project was completed by the team."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 42,
        "words": [
            "the students",
            "were given",
            "an assignment",
            "by the",
            "teacher"
        ],
        "correct": [
            "The students were given an assignment by the teacher."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 43,
        "words": [
            "neither",
            "the boy",
            "nor the girl",
            "wanted",
            "to do",
            "the chores"
        ],
        "correct": [
            "Neither the boy nor the girl wanted to do the chores."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 44,
        "words": [
            "the book",
            "which",
            "has a red",
            "cover",
            "is mine"
        ],
        "correct": [
            "The book, which has a red cover, is mine.",
            "The book is mine which has a red cover."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "5",
        "id": 45,
        "words": [
            "the game",
            "had",
            "ended",
            "when",
            "we got there"
        ],
        "correct": [
            "The game had ended when we got there."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 46,
        "words": [
            "not only",
            "did they win",
            "but they also",
            "celebrated",
            "with a party"
        ],
        "correct": [
            "Not only did they win, but they also celebrated with a party."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 47,
        "words": [
            "the homework",
            "was",
            "completed",
            "by the student"
        ],
        "correct": [
            "The homework was completed by the student."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 48,
        "words": [
            "he",
            "has been",
            "working",
            "on his project",
            "all day"
        ],
        "correct": [
            "He has been working on his project all day."
        ],
        "types": [],
        "required": 1
    },
    {
        "grade": "5",
        "id": 49,
        "words": [
            "the movie",
            "that",
            "was a comedy",
            "was",
            "watched",
            "by everyone"
        ],
        "correct": [
            "The movie that was a comedy was watched by everyone.",
            "The movie was watched by everyone that was a comedy."
        ],
        "types": [],
        "required": 2
    },
    {
        "grade": "5",
        "id": 50,
        "words": [
            "the girl",
            "had been",
            "reading",
            "for an hour",
            "before her",
            "friends",
            "arrived"
        ],
        "correct": [
            "The girl had been reading for an hour before her friends arrived."
        ],
        "types": [],
        "required": 1
    }
]
</script>




    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo, useCallback } = React;

        // --- Data ---
        // Load questions from the JSON data block in the HTML
        const allQuestions = JSON.parse(document.getElementById('question-data').textContent);

        // --- Utility Functions ---
        const shuffleArray = (array) => {
            let currentIndex = array.length, randomIndex;
            while (currentIndex !== 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        };

        // --- Icon Components ---
        const IconSpinner = ({ className }) => ( <svg className={className} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"> <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle> <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path> </svg> );
        const IconFullscreenEnter = () => ( <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg> );
        const IconFullscreenExit = () => ( <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"/></svg> );
        const IconCheck = () => ( <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg> );
        const IconReset = () => ( <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21.5 2v6h-6"/><path d="M2.5 22v-6h6"/><path d="M22 11.5A10 10 0 0 0 12.5 3a9.99 9.99 0 0 0-6.2 2.3L2.5 9"/><path d="M2 12.5A10 10 0 0 0 11.5 21a9.99 9.99 0 0 0 6.2-2.3L21.5 15"/></svg> );
        const IconNext = () => ( <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg> );
        const IconExport = () => ( <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg> );

        // --- Main App Component ---
        function App() {
          const [screen, setScreen] = useState('setup');
          const [isLoading, setIsLoading] = useState(false);
          const [error, setError] = useState(null);
          const [isFullscreen, setIsFullscreen] = useState(false);
          const [assessmentSettings, setAssessmentSettings] = useState(null);
          const [resultsData, setResultsData] = useState(null);
          
          const toggleFullscreen = () => {
            if (!document.fullscreenElement) {
              document.documentElement.requestFullscreen().catch(() => setError("Fullscreen not permitted."));
            } else if (document.exitFullscreen) {
              document.exitFullscreen();
            }
          };

          useEffect(() => {
            const handleFullscreenChange = () => setIsFullscreen(!!document.fullscreenElement);
            document.addEventListener('fullscreenchange', handleFullscreenChange);
            return () => document.removeEventListener('fullscreenchange', handleFullscreenChange);
          }, []);
          
          useEffect(() => {
            if (error) {
                const timeoutId = setTimeout(() => setError(null), 5000);
                return () => clearTimeout(timeoutId);
            }
          }, [error]);
          
          const handleStart = (settings) => {
            setAssessmentSettings(settings);
            setScreen('app');
          };
          const handleSubmit = (results) => {
            setResultsData(results);
            setScreen('results');
          };
          const handleRestart = () => {
            setAssessmentSettings(null);
            setResultsData(null);
            setScreen('setup');
          };

          const renderScreen = () => {
            switch (screen) {
              case 'app':
                return <MainAppScreen onSubmit={handleSubmit} settings={assessmentSettings} />;
              case 'results':
                return <ResultsScreen onRestart={handleRestart} results={resultsData} />;
              case 'assessmentSetup':
                return <AssessmentSetupScreen onStartAssessment={handleStart} />;
              case 'setup':
              default:
                return <TutorialScreen onStartAssessment={() => setScreen('assessmentSetup')} />;
            }
          };

          return (
            <div className="bg-[#5B4B62] min-h-screen font-sans text-[#dee2e6] relative">
              <button onClick={toggleFullscreen} className="absolute top-4 left-4 z-10 p-2 rounded-full bg-[#8B87A1]/50 hover:bg-[#C3B1E1] transition" title={isFullscreen ? "Exit Fullscreen" : "Enter Fullscreen"}> {isFullscreen ? <IconFullscreenExit /> : <IconFullscreenEnter />} </button>
              <a href="https://navacite.com" className="absolute top-4 right-4 z-10 p-1 rounded-full bg-[#8B87A1]/50 hover:bg-[#C3B1E1] transition" title="Back to Homepage"> <img src="https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/navacite-images/Navacite-Main.png" alt="Navacite Homepage" className="w-10 h-10 rounded-full"/> </a>
              <div className="container mx-auto p-4 sm:p-6 lg:p-8">
                <header className="text-center mb-8">
                  <img src="https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/navacite-images/navacite-gg.png" alt="App Gem" className="w-48 mx-auto mb-4 drop-shadow-[0_0_15px_rgba(255,255,255,0.7)]" />
                  <h1 className="text-4xl font-bold text-[7F00FF]">Grammar Grid</h1>
                  <p className="text-sm text-[#aea2a6] italic mt-2">Form sentences by rearranging and editing jumbled words and phrases.By working with word order and structure, students engage with the kinds of language tasks often used in writing, class discussion, and content area learning.</p>
                </header>
                {error && <div className="text-red-400 bg-red-900/50 p-3 rounded-lg text-center my-4 max-w-4xl mx-auto">{error}</div>}
                <main className="bg-[#8B87A1]/50 p-6 sm:p-8 rounded-2xl shadow-lg max-w-4xl mx-auto border border-[#AEA2A6]"> {renderScreen()} </main>
              </div>
            </div>
          );
        }

      // --- Tutorial Screen ---
        const TutorialScreen = ({ onStartAssessment }) => {
          const [words, setWords] = useState([ { id: 1, text: "tasty", inSentence: false }, { id: 2, text: "the ice cream", inSentence: false }, { id: 3, text: "is", inSentence: false } ]);
          const [sentence, setSentence] = useState([]);
          const [completedSentences, setCompletedSentences] = useState([]);
          const [shake, setShake] = useState(false);
          const [showPopup, setShowPopup] = useState(true);
          const [isCorrectGlow, setIsCorrectGlow] = useState(false);
          const [isFinishedGlow, setIsFinishedGlow] = useState(false);
          const [isWordBoxAnimated, setIsWordBoxAnimated] = useState(false);
          const audioRef = useRef({});
          const correctAnswers = [ "the ice cream is tasty", "is the ice cream tasty" ];
          
          const normalize = (str) => str.toLowerCase().replace(/[^\w\s]|_/g, "").replace(/\s+/g, " ").trim();

          useEffect(() => { 
              audioRef.current.tutorial = new Audio("https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/static/audio/grammar-grid/tutorial.wav");
              audioRef.current.statement = new Audio("https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/static/audio/grammar-grid/statement.wav");
              audioRef.current.question = new Audio("https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/static/audio/grammar-grid/question.wav");
              audioRef.current.finished = new Audio("https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/static/audio/grammar-grid/finished.wav"); 
              audioRef.current.correctAnswerSound = new Audio("https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/static/audio/grammar-grid/2_out_of_2.wav"); 
              audioRef.current.incorrect = new Audio("https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/static/audio/grammar-grid/incorrect.wav"); 
          }, []);

          const playAudio = (audioElement, onEnded) => { if (audioElement) { audioElement.onended = onEnded; audioElement.play().catch(e => console.error("Audio playback failed:", e)); } };
          
          const handleReset = () => { 
              setSentence([]); 
              setWords(words.map(w => ({ ...w, inSentence: false }))); 
          };

          const handleCheck = () => {
              if (sentence.length === 0) return;
              const userSentenceText = sentence.map(w => w.text).join(' ');
              const normalizedUserSentence = normalize(userSentenceText);
              const isCorrect = correctAnswers.includes(normalizedUserSentence) && !completedSentences.includes(userSentenceText);

              if (isCorrect) {
                  const newCompleted = [...completedSentences, userSentenceText];
                  setCompletedSentences(newCompleted);

                  if (newCompleted.length === 1) {
                      setIsCorrectGlow(true);
                      const audioToPlay = normalizedUserSentence === "the ice cream is tasty" ? audioRef.current.statement : audioRef.current.question;
                      playAudio(audioToPlay, () => {
                           setTimeout(() => {
                            setIsCorrectGlow(false);
                            handleReset();
                           }, 500);
                      });
                  } else if (newCompleted.length === 2) {
                      setIsFinishedGlow(true);
                      playAudio(audioRef.current.correctAnswerSound, () => {
                           setTimeout(() => {
                               setIsFinishedGlow(false);
                               playAudio(audioRef.current.finished, onStartAssessment);
                           }, 1500);
                      });
                  }
              } else {
                  setShake(true);
                  playAudio(audioRef.current.incorrect);
                  setTimeout(() => {
                      setShake(false);
                      handleReset();
                  }, 500);
              }
          };
          
          const handleWordClick = (wordId) => { const word = words.find(w => w.id === wordId); if (word && !word.inSentence) { setSentence(prev => [...prev, word]); setWords(prev => prev.map(w => w.id === wordId ? { ...w, inSentence: true } : w)); } };
          
          const currentDate = new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
          const sentencesNeeded = correctAnswers.length - completedSentences.length;

          return ( 
            <div className="space-y-8"> 
              {showPopup && ( 
                <div className="fixed inset-0 bg-black/70 flex items-center justify-center z-40"> 
                  <div className="bg-[#5B4B62] p-8 rounded-2xl shadow-lg border border-[#AEA2A6] text-center max-w-sm"> 
                    <p className="font-bold text-lg mb-4">Begin with tutorial? (audio required)</p> 
                    <div className="flex justify-center space-x-4"> 
                      <button onClick={() => { setShowPopup(false); playAudio(audioRef.current.tutorial, null); setIsWordBoxAnimated(true); setTimeout(() => setIsWordBoxAnimated(false), 2000); }} className="px-6 py-2 bg-[#DA70D6] rounded-lg font-semibold hover:bg-[#C3B1E1] transition"> Yes </button> 
                      <button onClick={() => { setShowPopup(false); onStartAssessment(); }} className="px-6 py-2 bg-[#DA70D6] rounded-lg font-semibold hover:bg-[#C3B1E1] transition"> No </button> 
                    </div> 
                  </div> 
                </div> 
              )} 
              <div className="text-center p-3 bg-[#8B87A1]/50 text-[#C3B1E1] rounded-lg"> <p className="font-semibold">{currentDate}</p> </div> 
              <div className="text-center"> 
                <h2 className="text-2xl font-bold text-[#dee2e6]">Tutorial</h2> 
                <p className="text-[#C3B1E1]">Make {correctAnswers.length} correct sentences. You still need {sentencesNeeded} more.</p>
              </div> 
              <div className={`p-4 min-h-[6rem] border border-dashed border-[#AEA2A6] rounded-lg flex flex-wrap items-center justify-center gap-2 transition-all duration-300 ${shake ? 'shake' : ''} ${isCorrectGlow || isFinishedGlow ? 'glow' : ''}`}> 
                {sentence.length > 0 ? sentence.map((word, i) => <span key={i} className="px-3 py-2 bg-[#AEA2A6]/50 text-[#5B4B62] rounded-lg shadow-sm font-semibold">{word.text}</span>) : <span className="text-sm text-[#aea2a6] italic">Click words below to build your sentence...</span>} 
              </div> 
              <div className="p-4 rounded-lg flex flex-wrap justify-center gap-2 bg-[#8B87A1]/50"> 
                {words.filter(w => !w.inSentence).map(word => ( <button key={word.id} onClick={() => handleWordClick(word.id)} className={`word-box px-4 py-2 bg-[#AEA2A6]/50 text-[#dee2e6] rounded-lg shadow-sm font-semibold ${isWordBoxAnimated ? 'animate' : ''}`}> {word.text} </button> ))} 
              </div> 
              <div className="flex items-center justify-center space-x-4 mt-8"> 
                <button onClick={handleCheck} className="flex items-center justify-center gap-2 px-5 py-3 bg-[#DA70D6] rounded-lg font-bold text-white hover:bg-[#C3B1E1] transition">
                    <IconCheck />
                    <span>Check Sentence</span>
                </button>
                <button onClick={handleReset} className="flex items-center justify-center gap-2 px-5 py-3 bg-[#DA70D6] rounded-lg font-bold text-white hover:bg-[#C3B1E1] transition">
                    <IconReset />
                    <span>Reset Blocks</span>
                </button>
                <button onClick={onStartAssessment} className="px-6 py-3 bg-[#DA70D6] rounded-lg text-white font-bold transition disabled:bg-gray-500 disabled:opacity-75 disabled:cursor-not-allowed" disabled={true} title="Please complete the tutorial first."> Pass </button> 
              </div> 
            </div> 
          );
        };

        
        // --- Assessment Setup Screen ---
        const AssessmentSetupScreen = ({ onStartAssessment }) => {
          const [examinerName, setExaminerName] = useState('');
          const [studentName, setStudentName] = useState('');
          const [isMultiGrade, setIsMultiGrade] = useState(false);
          const [singleGrade, setSingleGrade] = useState('K');
          const [numQuestions, setNumQuestions] = useState(10);
          const [multiGrades, setMultiGrades] = useState([ { id: 1, grade: 'K', questions: 0 }, { id: 2, grade: '1', questions: 0 }, { id: 3, grade: '2', questions: 0 } ]);
          
          const totalMultiQuestions = useMemo(() => multiGrades.reduce((sum, item) => sum + Number(item.questions || 0), 0), [multiGrades]);
          const questionsLeft = 10 - totalMultiQuestions;

          const handleMultiGradeChange = (id, field, value) => {
            setMultiGrades(prev => prev.map(item => item.id === id ? { ...item, [field]: value } : item));
          };
          
          const handleStart = () => {
              if (isMultiGrade) {
                  const grades = multiGrades.filter(g => g.questions > 0);
                  if (grades.length > 0 && totalMultiQuestions <= 10) {
                      onStartAssessment({ examinerName, studentName, grades, isMultiGrade: true });
                  }
              } else {
                  onStartAssessment({ examinerName, studentName, grades: [{ grade: singleGrade, questions: numQuestions }], numQuestions, isMultiGrade: false });
              }
          };

          const gradeOptions = [ {value: 'K', label: 'Kindergarten'}, ...[...Array(12)].map((_, i) => ({ value: (i + 1).toString(), label: `Grade ${i + 1}`})) ];

          return (
            <div className="space-y-8">
                <h2 className="text-2xl font-bold text-center">Assessment Setup</h2>
                <div className="flex flex-col space-y-2">
                  <label htmlFor="examiner" className="text-lg font-semibold">Examiner Name</label>
                  <input id="examiner" type="text" value={examinerName} onChange={(e) => setExaminerName(e.target.value)} className="p-3 rounded-lg bg-[#AEA2A6]/30 text-[#dee2e6] border border-[#AEA2A6] focus:outline-none focus:ring-2 focus:ring-[#C3B1E1]" placeholder="Enter examiner's name" />
                </div>

                <div className="flex flex-col space-y-2">
                  <label htmlFor="student" className="text-lg font-semibold">Student Name (Optional)</label>
                  <input id="student" type="text" value={studentName} onChange={(e) => setStudentName(e.target.value)} className="p-3 rounded-lg bg-[#AEA2A6]/30 text-[#dee2e6] border border-[#AEA2A6] focus:outline-none focus:ring-2 focus:ring-[#C3B1E1]" placeholder="Enter student's name" />
                   <p className="text-xs text-[#aea2a6] italic mt-1">This information is not stored and is FERPA compliant.</p>
                </div>
                
                <div className={`flex flex-col space-y-2 ${isMultiGrade ? 'hidden' : ''}`}>
                  <label htmlFor="grade-level" className="text-lg font-semibold">Grade Level</label>
                  <select id="grade-level" value={singleGrade} onChange={(e) => setSingleGrade(e.target.value)} className="p-3 rounded-lg bg-[#AEA2A6]/30 text-[#dee2e6] border border-[#AEA2A6] focus:outline-none focus:ring-2 focus:ring-[#C3B1E1]">
                    {gradeOptions.map(opt => {
                        const gradeNum = parseInt(opt.value, 10);
                        const isDisabled = gradeNum >= 6;
                        return (
                            <option key={opt.value} value={opt.value} disabled={isDisabled}>
                                {opt.label}{isDisabled ? ' (coming soon...)' : ''}
                            </option>
                        );
                    })}
                  </select>
                </div>
                
                <div className="flex items-center space-x-2">
                  <input id="multi-grade" type="checkbox" checked={isMultiGrade} onChange={(e) => setIsMultiGrade(e.target.checked)} className="w-5 h-5 accent-[#DA70D6] rounded"/>
                  <label htmlFor="multi-grade" className="text-lg font-semibold">Select multiple grade levels</label>
                </div>

                {isMultiGrade ? (
                  <div className="bg-[#8B87A1]/40 p-6 rounded-lg space-y-4">
                    <h3 className="text-xl font-semibold text-[#dee2e6]">Questions by Grade Level (Left: {questionsLeft})</h3>
                    {multiGrades.map(item => (
                      <div key={item.id} className="flex items-center space-x-4">
                        <select value={item.grade} onChange={(e) => handleMultiGradeChange(item.id, 'grade', e.target.value)} className="p-2 rounded-lg bg-[#AEA2A6]/30 text-[#dee2e6] border border-[#AEA2A6]">
                          {gradeOptions.map(opt => {
                            const gradeNum = parseInt(opt.value, 10);
                            const isDisabled = gradeNum >= 6;
                            return (
                                <option key={opt.value} value={opt.value} disabled={isDisabled}>
                                    {opt.label}{isDisabled ? ' (coming soon...)' : ''}
                                </option>
                            );
                        })}
                        </select>
                        <label className="text-lg font-medium">Questions</label>
                        <input type="number" value={item.questions} onChange={(e) => { const val = Math.max(0, parseInt(e.target.value) || 0); handleMultiGradeChange(item.id, 'questions', val); }} min="0" className="w-20 p-2 rounded-lg bg-[#AEA2A6]/30 text-[#dee2e6] border border-[#AEA2A6]"/>
                      </div>
                    ))}
                    <p className={`text-sm font-semibold ${questionsLeft < 0 ? 'text-red-400' : 'text-[#dee2e6]'}`}>Total Questions: {totalMultiQuestions}/10</p>
                  </div>
                ) : (
                  <div className="flex flex-col space-y-2">
                    <label htmlFor="num-questions" className="text-lg font-semibold">Number of Questions (max 10)</label>
                    <input id="num-questions" type="number" value={numQuestions} onChange={(e) => setNumQuestions(Math.max(1, Math.min(10, e.target.value)))} min="1" max="10" className="p-3 rounded-lg bg-[#AEA2A6]/30 text-[#dee2e6] border border-[#AEA2A6]"/>
                  </div>
                )}
                
                <button onClick={handleStart} disabled={(isMultiGrade && (totalMultiQuestions === 0 || totalMultiQuestions > 10)) || !examinerName} className={`w-full py-4 bg-[#DA70D6] rounded-lg font-bold text-lg hover:bg-[#C3B1E1] transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed`}> Start Assessment </button>
            </div>
          );
        };

// --- Main Assessment Screen ---
        const MainAppScreen = ({ onSubmit, settings }) => {
            const [questions, setQuestions] = useState([]);
            const [currentQIndex, setCurrentQIndex] = useState(0);
            const [currentSentence, setCurrentSentence] = useState([]);
            const [shuffledWords, setShuffledWords] = useState([]);
            const [completedSentences, setCompletedSentences] = useState([]);
            const [shake, setShake] = useState(false);
            const [isQuestionCompleteGlow, setIsQuestionCompleteGlow] = useState(false);
            const [isCorrectGlow, setIsCorrectGlow] = useState(false);
            const [isChangingQuestion, setIsChangingQuestion] = useState(false);
            const audioRef = useRef({});
            
            const [score, setScore] = useState(0);
            const [totalPossibleScore, setTotalPossibleScore] = useState(0);
            const [struggledTypes, setStruggledTypes] = useState({
                "Active Declarative": 0, "Causative Verb": 0, "Commas in a Series": 0, "Coordinating Conjunction": 0,
                "Correlative Conjunction": 0, "Direct and Indirect Object": 0, "Gerund as a Subject": 0,
                "Infinitive Phrase": 0, "Infinitive Phrase as Subject": 0, "Interrogative": 0, "Negative": 0,
                "Participle Phrase": 0, "Passive Declarative": 0, "Passive Interrogative": 0, "Passive Verb Form": 0,
                "Perfect Progressive Tense": 0, "Perfect Verb Tense": 0, "Prepositional Phrase": 0,
                "Progressive Verb Tense": 0, "Proper Noun": 0, "Relative Clause": 0, "Subjunctive Mood": 0,
                "Subordinate Clause": 0, "Subordinate Clause as Subject": 0
            });
            const [assessmentLog, setAssessmentLog] = useState([]);

            const normalize = (str) => str.toLowerCase().replace(/[^\w\s]|_/g, "").replace(/\s+/g, " ").trim();
            
            const getShuffledWords = (words, correctAnswers) => {
                const correctOrders = correctAnswers.map(ans => normalize(ans));
                let shuffled;
                let isCorrectOrder = true;
                let attempts = 0; // Safety break for infinite loops
                while (isCorrectOrder && attempts < 10) {
                    shuffled = shuffleArray([...words]);
                    const shuffledSentence = normalize(shuffled.join(' '));
                    isCorrectOrder = correctOrders.some(ans => ans.startsWith(shuffledSentence));
                    attempts++;
                }
                return shuffled;
            };

            const relevantTypes = useMemo(() => {
                if (!questions || questions.length === 0) return [];
                const types = new Set(["Active Declarative"]);
                questions.forEach(q => {
                    if (q.types && q.types.length > 0) {
                        q.types.forEach(type => types.add(type));
                    }
                });
                return Array.from(types);
            }, [questions]);

            useEffect(() => {
                audioRef.current.correctAnswerSound = new Audio("https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/static/audio/grammar-grid/2_out_of_2.wav");
            }, []);

            useEffect(() => {
                let questionPool = [];
                if (settings.isMultiGrade) {
                    settings.grades.forEach(({ grade, questions: count }) => {
                        const gradeQuestions = allQuestions.filter(q => q.grade === grade);
                        questionPool.push(...shuffleArray(gradeQuestions).slice(0, count));
                    });
                } else {
                    const gradeQuestions = allQuestions.filter(q => q.grade === settings.grades[0].grade);
                    questionPool = shuffleArray(gradeQuestions).slice(0, settings.numQuestions);
                }
                
                const finalQuestions = shuffleArray(questionPool);
                setQuestions(finalQuestions);
                setTotalPossibleScore(finalQuestions.reduce((acc, q) => acc + q.required, 0));
            }, [settings]);

            const currentQuestion = questions[currentQIndex];

            useEffect(() => {
                if (questions.length > 0 && currentQIndex < questions.length) {
                    setShuffledWords(getShuffledWords(currentQuestion.words, currentQuestion.correct));
                    setCurrentSentence([]);
                    setCompletedSentences([]);
                }
            }, [currentQIndex, questions]);


            const handleNextQuestion = useCallback(() => {
                const logEntry = {
                    question: currentQuestion,
                    correctlyFormed: completedSentences,
                    score: `${completedSentences.length}/${currentQuestion.required}`
                };
                setAssessmentLog(prev => [...prev, logEntry]);

                setIsChangingQuestion(true);
                setTimeout(() => {
                    if (currentQIndex < questions.length - 1) {
                        setCurrentQIndex(prev => prev + 1);
                        setIsChangingQuestion(false);
                    } else {
                        onSubmit({
                            settings,
                            finalScore: score,
                            totalPossible: totalPossibleScore,
                            struggledTypes,
                            log: [...assessmentLog, logEntry],
                            relevantTypes
                        });
                    }
                }, 1000);
            }, [currentQIndex, questions, completedSentences, currentQuestion, assessmentLog, onSubmit, score, totalPossibleScore, struggledTypes, settings, relevantTypes]);

            useEffect(() => {
                if (currentQuestion && completedSentences.length > 0 && completedSentences.length === currentQuestion.required) {
                    setIsQuestionCompleteGlow(true);
                    const timer = setTimeout(() => {
                        setIsQuestionCompleteGlow(false);
                        handleNextQuestion();
                    }, 2000);
                    return () => clearTimeout(timer);
                }
            }, [completedSentences, currentQuestion, handleNextQuestion]);

            const handleWordClick = useCallback((word) => {
                setCurrentSentence(prev => [...prev, word]);
                setShuffledWords(prev => prev.filter(w => w !== word));
            }, []);
            
            const handleReset = useCallback(() => {
                setCurrentSentence([]);
                if (currentQuestion) {
                    setShuffledWords(getShuffledWords(currentQuestion.words, currentQuestion.correct));
                }
            }, [currentQuestion]);

            const handleCheck = useCallback(() => {
                const sentenceText = currentSentence.join(' ');
                const normalizedUserSentence = normalize(sentenceText);
                const isCorrect = currentQuestion.correct.some(correctAnswer => normalize(correctAnswer) === normalizedUserSentence) && !completedSentences.includes(sentenceText);
                
                if (isCorrect) {
                    if (audioRef.current.correctAnswerSound) {
                        audioRef.current.correctAnswerSound.play();
                    }
                    setIsCorrectGlow(true);
                    setTimeout(() => setIsCorrectGlow(false), 1500);
                    setScore(s => s + 1);
                    setCompletedSentences(prev => [...prev, sentenceText]);
                } else {
                    setShake(true);
                    setTimeout(() => setShake(false), 500);
                    const allTypes = ["Active Declarative", ...currentQuestion.types];
                    allTypes.forEach(type => {
                        setStruggledTypes(prev => prev.hasOwnProperty(type) ? { ...prev, [type]: prev[type] + 1 } : prev);
                    });
                }
                handleReset();
            }, [currentSentence, currentQuestion, completedSentences, handleReset]);
            
            const handlePass = useCallback(() => {
                const allTypes = ["Active Declarative", ...currentQuestion.types];
                allTypes.forEach(type => {
                    setStruggledTypes(prev => prev.hasOwnProperty(type) ? { ...prev, [type]: prev[type] + 1 } : prev);
                });
                handleNextQuestion();
            }, [currentQuestion, handleNextQuestion]);
            
            useEffect(() => {
                const handleKeyDown = (e) => {
                    if (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'SELECT') return;

                    const key = e.key;
                    if (key >= '1' && key <= '9') {
                        const index = parseInt(key, 10) - 1;
                        if (shuffledWords[index]) handleWordClick(shuffledWords[index]);
                    } else if (key === '0') {
                        if (shuffledWords[9]) handleWordClick(shuffledWords[9]);
                    }

                    switch (key) {
                        case '-': e.preventDefault(); handleCheck(); break;
                        case '=': e.preventDefault(); handleReset(); break;
                        case 'ArrowRight': e.preventDefault(); handlePass(); break;
                        default: break;
                    }
                };

                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, [shuffledWords, handleWordClick, handleCheck, handleReset, handlePass]);

            if (isChangingQuestion || !currentQuestion) {
                 return (
                    <div className="flex flex-col items-center justify-center space-y-4 min-h-[50vh]">
                        <img src="https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/static/grammar-grid/gg_blocks.png" alt="Loading..." className="w-52 h-auto loading-pulse" />
                        <p className="text-lg font-semibold text-[#C3B1E1]">Loading next question...</p>
                    </div>
                );
            }

            const sentencesNeeded = currentQuestion.required - completedSentences.length;

            return (
                <div className="space-y-6">
                    <div className="text-center p-3 bg-[#8B87A1]/50 text-[#C3B1E1] rounded-lg flex justify-between items-center">
                        <p className="font-semibold">Question {currentQIndex + 1} of {questions.length}</p>
                        <p className="font-bold text-lg">Score: {score}</p>
                    </div>

                    <div className="flex justify-between items-center mb-4">
                        <div className="w-1/3 text-left">
                            <h3 className="font-semibold text-sm text-[#C3B1E1]">Completed:</h3>
                            {completedSentences.length > 0 ? (
                                <ul className="list-disc list-inside text-xs">
                                    {completedSentences.map((s, i) => <li key={i}>{s}</li>)}
                                </ul>
                            ) : (
                                <p className="text-xs italic text-[#aea2a6]">None yet.</p>
                            )}
                        </div>
                        <div className="w-1/3 text-center">
                            <h2 className="text-xl font-bold text-[#dee2e6]"> Make {currentQuestion.required} correct sentence{currentQuestion.required > 1 ? 's' : ''}. </h2>
                            {sentencesNeeded > 0 ? <p className="text-[#C3B1E1]">You still need {sentencesNeeded} more.</p> : <p className="text-green-400 font-bold">Great!</p>}
                        </div>
                         <div className="w-1/3 flex justify-end">
                            <img src="https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/static/grammar-grid/gg_blocks.png" alt="Grammar Blocks" className={`w-32 h-auto transition-all duration-500 ${isQuestionCompleteGlow ? 'image-glow' : ''}`} />
                        </div>
                    </div>

                    <div className={`p-4 min-h-[6rem] border border-dashed border-[#AEA2A6] rounded-lg flex flex-wrap items-center justify-center gap-2 ${shake ? 'shake' : ''} ${isQuestionCompleteGlow || isCorrectGlow ? 'glow' : ''}`}>
                        {currentSentence.map((word, i) => <span key={i} className="px-3 py-2 bg-[#AEA2A6]/50 text-[#5B4B62] rounded-lg shadow-sm font-semibold">{word}</span>)}
                    </div>
                    
                    <div className="p-4 rounded-lg flex flex-wrap justify-center gap-4 bg-[#8B87A1]/50 min-h-[6rem]">
                        {shuffledWords.map((word, i) => (
                            <div key={i} className="text-center">
                                <button onClick={() => handleWordClick(word)} className="word-box px-4 py-2 bg-[#AEA2A6]/50 text-[#dee2e6] rounded-lg shadow-sm font-semibold hover:bg-[#C3B1E1]">
                                    {word}
                                </button>
                                <span className="text-xs text-[#C3B1E1] mt-1 block">{i < 9 ? i + 1 : 0}</span>
                            </div>
                        ))}
                    </div>

                    <div className="flex items-start justify-center space-x-4 mt-6">
                        <div className="text-center">
                            <button onClick={handleCheck} className="flex items-center justify-center gap-2 px-5 py-3 bg-[#DA70D6] rounded-lg font-bold text-white hover:bg-[#C3B1E1] transition"> <IconCheck /> <span>Check</span> </button>
                            <span className="text-xs text-[#C3B1E1] mt-1 block">-</span>
                        </div>
                        <div className="text-center">
                            <button onClick={handleReset} className="flex items-center justify-center gap-2 px-5 py-3 bg-[#DA70D6] rounded-lg font-bold text-white hover:bg-[#C3B1E1] transition"> <IconReset /> <span>Reset</span> </button>
                             <span className="text-xs text-[#C3B1E1] mt-1 block">=</span>
                        </div>
                        <div className="text-center">
                            <button onClick={handlePass} className="px-6 py-3 bg-[#DA70D6] rounded-lg text-white font-bold hover:bg-[#C3B1E1] transition"> Pass </button>
                            <span className="text-xs text-[#C3B1E1] mt-1 block"></span>
                        </div>
                    </div>
                </div>
            );
        };

        
        // --- Results Screen ---
        const ResultsScreen = ({ onRestart, results }) => {
            const handleExport = () => {
                const { settings, finalScore, totalPossible, struggledTypes, log, relevantTypes } = results;
                const date = new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
                const scorePercentage = totalPossible > 0 ? ((finalScore / totalPossible) * 100).toFixed(0) : 0;
                
                const struggledTypesRows = Object.entries(struggledTypes)
                    .filter(([type, count]) => relevantTypes.includes(type))
                    .map(([type, count]) => `<tr><td>${type} Errors</td><td>${count}</td></tr>`)
                    .join('');

                const reportHTML = `
                    <!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Grammar Grid Report</title>
                    <style>
                        body { font-family: sans-serif; background-color: #5B4B62; color: #dee2e6; line-height: 1.6; margin: 0; padding: 20px; }
                        .container { max-width: 800px; margin: auto; padding: 20px; background-color: #8B87A1; border-radius: 12px; border: 1px solid #AEA2A6; }
                        header { text-align: center; border-bottom: 1px solid #AEA2A6; padding-bottom: 15px; margin-bottom: 25px; }
                        header img { max-width: 120px; margin-bottom: 10px; filter: drop-shadow(0 0 10px rgba(255,255,255,0.5)); }
                        h1 { color: #DA70D6; margin: 0; } h2 { color: #C3B1E1; border-bottom: 1px solid #AEA2A6; padding-bottom: 8px; margin-top: 25px; }
                        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; background-color: #5B4B62; padding: 15px; border-radius: 8px; }
                        .info-grid p { margin: 0; } .info-grid strong { color: #C3B1E1; }
                        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
                        th, td { text-align: left; padding: 10px; border-bottom: 1px solid #AEA2A6; }
                        th { background-color: #5B4B62; }
                        .total-row { font-weight: bold; color: #DA70D6; }
                        .question-block { margin-top: 15px; padding: 10px; background-color: #5B4B62; border-radius: 8px; }
                        .word-bank { font-style: italic; color: #C3B1E1; }
                        .user-answer { margin-left: 20px; }
                        .correct { color: #6ee7b7; } .incorrect { color: #f87171; }
                    </style></head><body>
                    <div class="container">
                        <header>
                            <img src="https://raw.githubusercontent.com/navasdo/navacite/refs/heads/main/templates/navacite-images/navacite-gg.png" alt="Grammar Grid Gem">
                            <h1>Assessment Report</h1>
                        </header>
                        <section>
                            <h2>Summary</h2>
                            <div class="info-grid">
                                <p><strong>Student Name:</strong> ${settings.studentName || '_______________________'}</p>
                                <p><strong>Examiner:</strong> ${settings.examinerName}</p>
                                <p><strong>Date:</strong> ${date}</p>
                            </div>
                        </section>
                        <section>
                            <h2>Scores</h2>
                            <table>
                                <thead><tr><th>Category</th><th>Score</th></tr></thead>
                                <tbody>
                                    ${struggledTypesRows}
                                    <tr class="total-row"><td>Total Score</td><td>${finalScore}/${totalPossible} (${scorePercentage}%)</td></tr>
                                </tbody>
                            </table>
                        </section>
                        <section>
                            <h2>Details</h2>
                            ${log.map((entry, index) => `
                                <div class="question-block">
                                    <p><strong>Question ${index + 1}:</strong> Make ${entry.question.required} sentence(s).</p>
                                    <p class="word-bank">Words: ${entry.question.words.join(', ')}</p>
                                    <p><strong>Correct Possible Answers:</strong></p>
                                    <ul>${entry.question.correct.map(c => `<li>${c}</li>`).join('')}</ul>
                                    <p><strong>Student's Correct Sentences:</strong> 
                                        <span class="${entry.correctlyFormed.length === entry.question.required ? 'correct' : 'incorrect'}">
                                            (${entry.score})
                                        </span>
                                    </p>
                                    ${entry.correctlyFormed.length > 0 ? `<ul>${entry.correctlyFormed.map(s => `<li>${s}</li>`).join('')}</ul>` : '<p>No correct sentences formed.</p>'}
                                </div>
                            `).join('')}
                        </section>
                    </div></body></html>
                `;

                const blob = new Blob([reportHTML], { type: 'text/html' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `Grammar-Grid-Report_${date}.html`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            if (!results) return <div>Loading results...</div>;

            const { settings, finalScore, totalPossible, struggledTypes, relevantTypes } = results;
            const scorePercentage = totalPossible > 0 ? ((finalScore / totalPossible) * 100).toFixed(0) : 0;

            return (
                <div className="space-y-6 text-center">
                    <h2 className="text-3xl font-bold text-white">Assessment Complete</h2>
                    <div className="p-6 bg-[#8B87A1]/60 rounded-lg text-left max-w-md mx-auto">
                        <p className="text-lg"><strong className="text-[#C3B1E1]">Examiner:</strong> {settings.examinerName}</p>
                        <p className="text-lg"><strong className="text-[#C3B1E1]">Student:</strong> {settings.studentName || 'N/A'}</p>
                        <p className="text-lg"><strong className="text-[#C3B1E1]">Final Score:</strong> <span className="font-bold text-2xl text-[#DA70D6]">{finalScore}/{totalPossible}</span> ({scorePercentage}%)</p>
                        {Object.entries(struggledTypes)
                            .filter(([type, count]) => relevantTypes.includes(type))
                            .map(([type, count]) => (
                            <p key={type} className="text-lg"><strong className="text-[#C3B1E1]">{type} Errors:</strong> {count}</p>
                        ))}
                    </div>
                    <div className="flex justify-center items-center space-x-4">
                        <button onClick={handleExport} className="flex items-center space-x-2 px-6 py-3 bg-[#DA70D6] rounded-lg font-bold hover:bg-[#C3B1E1] transition">
                           <IconExport />
                           <span>Export Report</span>
                        </button>
                        <button onClick={onRestart} className="px-6 py-3 bg-[#DA70D6] rounded-lg font-bold hover:bg-[#C3B1E1] transition">
                           New Assessment
                        </button>
                    </div>
                </div>
            );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>

